\documentclass{word}
\usepackage{listings}
\lstset{
  basicstyle=\ttfamily,
  commentstyle=\textit,
  frame=trBL,
  numbers=left,
  breaklines=true,
  title=\lstname,
}
\usepackage{fancybox}
\usepackage{url}

\subtitle{ヘッダの見出し}
\author{ほげ}

\begin{document}

\chapter{記事の書き方}

\section{まずはじめに}

\subsection{p\LaTeX を使う}

\subsubsection{macOS・Linux}

$article\_name$は適当な名前として、以下のようなコマンドでブランチを分けましょう。

\begin{lstlisting}[mathescape]
git submodule update --init
git checkout -b personal/$username$/$article\_name$
cd ./articles
cp -r ./hinagata ./my-article-name
cd ./my-article-name
autoconf
./configure
\end{lstlisting}

\subsubsection{Windows}

WORDクラスファイルはWindowsでもコンパイルすることができます。
次のように\lstinline|cmake|を使います。

\begin{lstlisting}[mathescape]
git submodule update --init
git checkout -b personal/$username$/$article\_name$
cd ./articles
cp -r ./hinagata ./my-article-name
cd ./my-article-name
cmake -DENABLE_LUATEX=OFF .
\end{lstlisting}

\subsection{選択: Lua\LaTeX を使う}

WORDでは新たにLua\LaTeX が使えるようになりました。
使い方は、\lstinline|./configure|のかわりに\lstinline|./configure --enable-luatex|としてください。
Windowsの場合は、\lstinline|cmake -DENABLE_LUATEX=OFF .|のかわりに
\lstinline|cmake -DENABLE_LUATEX=ON .|としてください。

\section{記事を書く}

記事を書いたら、\lstinline|make|コマンドでビルドできます。
Windowsの場合は\lstinline|cmake|コマンドでビルドします。

\subsection{macOS・Linux}

\begin{lstlisting}
git add *
make
\end{lstlisting}

\subsection{Windows}

\begin{lstlisting}
git add *
cmake --build .
\end{lstlisting}

これで\ovalbox{main.pdf}が生成されれば成功です。
あとは\ovalbox{main.tex}を編集すれば記事が出来ます。

\section{Gitサーバにpushする}

記事のキリの良いところで\lstinline|git push|するといいのですが、最初のpushの時には、
origin\footnote{ここではWORDのGitサーバである\url{gitolite.word-ac.net}のことです}%
に新しいブランチを登録する必要があります。それは以下のようにしましょう。

\begin{lstlisting}[mathescape]
git push origin personal/$username$/$article\_name$
\end{lstlisting}

pushを成功させた場合には、ビルドの結果がslack\footnote{\url{https://word-ac.slack.com}}の\#jenkinsチャンネルに流れます。
slackを見ていない場合は、\url{https://jenkins.word-ac.net/job/LaTeX/}および\url{https://gitiles.word-ac.net/}を見ると良いでしょう。

\section{トラブルシューティング}

\subsection{偶数頁}

編集作業をしていると、レイアウトの問題で偶数頁から開始していただくことがあります。その場合の対処法は、\TeX の処理系によって以下のように異なります。

\subsubsection{p\LaTeX を使う場合}

その場合は、プレアンブルに以下を追加してください。

\begin{lstlisting}[language=TeX, mathescape]
\setcounter{page}{2}
\end{lstlisting}

\subsubsection{Lua\LaTeX を使う場合}

\lstinline|\documentclass|のオプションに\ovalbox{swapheader}をつけることで簡単にできます。

\begin{lstlisting}[language=TeX, mathescape]
\documentclass[swapheader]{word-lua}
\end{lstlisting}

\section{鍵の登録}

Gitサーバに鍵を登録しないと、pushできません。もしそれが原因でつまっている場合には、誰か権限を持っていそうな人に頼んで登録してもらいましょう。2016年6月現在では、
pi8027, yyu, ioriveur, shinkbr, osyoyu, chris, nymphiumが部員を登録できます。鍵が変わった場合も声をかけましょう。

\section{他の問題について}

問題があればslackの\#latexチャンネルや、編集会議で聞くと良いでしょう。

直接詳しい人にSNSで聞く場合、@\_yyu\_\footnote{\url{https://twitter.com/_yyu_}}へ投げると早い。
word-luaに関しては@Nymphium\footnote{\url{https://twitter.com/Nymphium}}か@azuma962\footnote{\url{https://twitter.com/azuma962}}へ。


\end{document}
